{"version":3,"sources":["../../../../app/bookings/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { useParams, useRouter } from \"next/navigation\"\r\nimport { apiClient } from \"@/lib/services/api\"\r\nimport { useAuth } from \"@/lib/hooks/use-auth\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card } from \"@/components/ui/card\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { \r\n  Loader2, \r\n  Calendar, \r\n  MapPin, \r\n  Clock, \r\n  DollarSign, \r\n  Edit, \r\n  Trash2, \r\n  ArrowLeft,\r\n  CheckCircle,\r\n  XCircle,\r\n  CreditCard,\r\n  AlertCircle\r\n} from \"lucide-react\"\r\nimport Link from \"next/link\"\r\nimport Image from \"next/image\"\r\nimport type { Property } from \"@/lib/types\"\r\n\r\ninterface Booking {\r\n  id: number\r\n  userId: number\r\n  propertyId: number | string\r\n  checkInDate: string\r\n  checkOutDate: string\r\n  totalPrice: number\r\n  status: string\r\n  longStayDiscountPercent?: number\r\n  requestedNegotiationPercent?: number\r\n  negotiationExpiresAt?: string\r\n  onChainTxHash?: string\r\n  createdAt?: string\r\n  updatedAt?: string\r\n}\r\n\r\nexport default function BookingDetailPage() {\r\n  const params = useParams()\r\n  const router = useRouter()\r\n  const { user, isAuthenticated } = useAuth()\r\n  const [booking, setBooking] = useState<Booking | null>(null)\r\n  const [property, setProperty] = useState<Property | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [error, setError] = useState(\"\")\r\n  const [actionLoading, setActionLoading] = useState(false)\r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [editForm, setEditForm] = useState({\r\n    checkInDate: \"\",\r\n    checkOutDate: \"\",\r\n    numberOfGuests: 1,\r\n    requestedPrice: \"\",\r\n  })\r\n  const [basePrice, setBasePrice] = useState<number | null>(null)\r\n  const [propertyInfo, setPropertyInfo] = useState<{\r\n    pricePerNight?: number\r\n    isNegotiable?: boolean\r\n    discountEnabled?: boolean\r\n    negotiationPercentage?: number\r\n  } | null>(null)\r\n\r\n  const bookingId = params.id as string\r\n\r\n  useEffect(() => {\r\n    if (bookingId) {\r\n      fetchBooking()\r\n    }\r\n  }, [bookingId])\r\n\r\n  useEffect(() => {\r\n    if (booking?.propertyId) {\r\n      fetchProperty()\r\n      fetchPropertyInfo()\r\n    }\r\n  }, [booking?.propertyId])\r\n\r\n  useEffect(() => {\r\n    if (isEditing && editForm.checkInDate && editForm.checkOutDate && propertyInfo?.pricePerNight) {\r\n      calculateBasePrice()\r\n    }\r\n  }, [isEditing, editForm.checkInDate, editForm.checkOutDate, propertyInfo])\r\n\r\n  const fetchBooking = async () => {\r\n    try {\r\n      setIsLoading(true)\r\n      setError(\"\")\r\n      const data = await apiClient.bookings.getById(bookingId)\r\n      setBooking(data)\r\n      setEditForm({\r\n        checkInDate: data.checkInDate || \"\",\r\n        checkOutDate: data.checkOutDate || \"\",\r\n        numberOfGuests: 1,\r\n        requestedPrice: data.requestedNegotiationPercent ? \"\" : (data.totalPrice?.toString() || \"\"),\r\n      })\r\n    } catch (err: any) {\r\n      console.error(\"Failed to fetch booking:\", err)\r\n      setError(err.message || \"Failed to load booking details\")\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const fetchProperty = async () => {\r\n    if (!booking?.propertyId) return\r\n    try {\r\n      const data = await apiClient.properties.getById(String(booking.propertyId))\r\n      setProperty(data)\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch property:\", err)\r\n    }\r\n  }\r\n\r\n  const fetchPropertyInfo = async () => {\r\n    if (!booking?.propertyId) return\r\n    try {\r\n      const info = await apiClient.bookings.getPropertyInfo(String(booking.propertyId))\r\n      setPropertyInfo(info)\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch property info:\", err)\r\n    }\r\n  }\r\n\r\n  const calculateBasePrice = () => {\r\n    if (!editForm.checkInDate || !editForm.checkOutDate || !propertyInfo?.pricePerNight) return\r\n\r\n    try {\r\n      const checkIn = new Date(editForm.checkInDate)\r\n      const checkOut = new Date(editForm.checkOutDate)\r\n      const nights = Math.ceil((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24))\r\n      const calculatedPrice = Number(propertyInfo.pricePerNight) * nights\r\n      setBasePrice(calculatedPrice)\r\n    } catch (err) {\r\n      console.error(\"Error calculating base price:\", err)\r\n    }\r\n  }\r\n\r\n  const handleEdit = () => {\r\n    setIsEditing(true)\r\n  }\r\n\r\n  const handleCancelEdit = () => {\r\n    setIsEditing(false)\r\n    if (booking) {\r\n      setEditForm({\r\n        checkInDate: booking.checkInDate || \"\",\r\n        checkOutDate: booking.checkOutDate || \"\",\r\n        numberOfGuests: 1,\r\n        requestedPrice: booking.requestedNegotiationPercent ? \"\" : (booking.totalPrice?.toString() || \"\"),\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleUpdate = async () => {\r\n    if (!booking) return\r\n\r\n    // Validate dates\r\n    if (!editForm.checkInDate || !editForm.checkOutDate) {\r\n      setError(\"Please fill in all required fields\")\r\n      return\r\n    }\r\n\r\n    const checkIn = new Date(editForm.checkInDate)\r\n    const checkOut = new Date(editForm.checkOutDate)\r\n    const today = new Date()\r\n    today.setHours(0, 0, 0, 0)\r\n\r\n    if (checkIn < today) {\r\n      setError(\"Check-in date must be today or later\")\r\n      return\r\n    }\r\n\r\n    if (checkOut <= checkIn) {\r\n      setError(\"Check-out date must be after check-in date\")\r\n      return\r\n    }\r\n\r\n    setActionLoading(true)\r\n    setError(\"\")\r\n\r\n    try {\r\n      const updateData: any = {\r\n        checkInDate: editForm.checkInDate,\r\n        checkOutDate: editForm.checkOutDate,\r\n        numberOfGuests: editForm.numberOfGuests,\r\n      }\r\n\r\n      if (editForm.requestedPrice) {\r\n        updateData.requestedPrice = parseFloat(editForm.requestedPrice)\r\n      }\r\n\r\n      const response = await apiClient.bookings.update(booking.id, updateData)\r\n\r\n      if (response.hasNegotiation === false && updateData.requestedPrice && basePrice) {\r\n        // No negotiation - redirect to payment\r\n        setTimeout(() => {\r\n          router.push(`/payment?bookingId=${booking.id}`)\r\n        }, 1000)\r\n      } else {\r\n        // Refresh booking\r\n        await fetchBooking()\r\n        setIsEditing(false)\r\n      }\r\n    } catch (err: any) {\r\n      setError(err.message || \"Failed to update booking\")\r\n    } finally {\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleDelete = async () => {\r\n    if (!booking) return\r\n    if (!window.confirm(\"Are you sure you want to cancel this booking? This action cannot be undone.\")) {\r\n      return\r\n    }\r\n\r\n    setActionLoading(true)\r\n    setError(\"\")\r\n\r\n    try {\r\n      await apiClient.bookings.delete(booking.id)\r\n      router.push(\"/my-bookings\")\r\n    } catch (err: any) {\r\n      setError(err.message || \"Failed to cancel booking\")\r\n      setActionLoading(false)\r\n    }\r\n  }\r\n\r\n  const formatDate = (dateString: string) => {\r\n    if (!dateString) return \"N/A\"\r\n    try {\r\n      const date = new Date(dateString)\r\n      return date.toLocaleDateString(\"en-US\", { \r\n        year: \"numeric\", \r\n        month: \"long\", \r\n        day: \"numeric\" \r\n      })\r\n    } catch {\r\n      return dateString\r\n    }\r\n  }\r\n\r\n  const calculateNights = (checkIn: string, checkOut: string) => {\r\n    if (!checkIn || !checkOut) return 0\r\n    try {\r\n      const checkInDate = new Date(checkIn)\r\n      const checkOutDate = new Date(checkOut)\r\n      const diffTime = Math.abs(checkOutDate.getTime() - checkInDate.getTime())\r\n      return Math.ceil(diffTime / (1000 * 60 * 60 * 24))\r\n    } catch {\r\n      return 0\r\n    }\r\n  }\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status.toUpperCase()) {\r\n      case \"PENDING_PAYMENT\":\r\n        return <Badge className=\"bg-blue-100 text-blue-800 border-blue-200\">Awaiting Payment</Badge>\r\n      case \"PENDING_NEGOTIATION\":\r\n      case \"PENDING\":\r\n        return <Badge className=\"bg-yellow-100 text-yellow-800 border-yellow-200\">Pending</Badge>\r\n      case \"CONFIRMED\":\r\n        return <Badge className=\"bg-green-100 text-green-800 border-green-200\">Confirmed</Badge>\r\n      case \"COMPLETED\":\r\n        return <Badge className=\"bg-gray-100 text-gray-800 border-gray-200\">Completed</Badge>\r\n      case \"TENANT_CHECKED_OUT\":\r\n        return <Badge className=\"bg-purple-100 text-purple-800 border-purple-200\">Checked Out</Badge>\r\n      case \"CANCELLED\":\r\n        return <Badge className=\"bg-red-100 text-red-800 border-red-200\">Cancelled</Badge>\r\n      default:\r\n        return <Badge className=\"bg-gray-100 text-gray-800 border-gray-200\">{status}</Badge>\r\n    }\r\n  }\r\n\r\n  // Helper function to get property image\r\n  const getPropertyImage = (property?: Property) => {\r\n    if (!property?.propertyImages || property.propertyImages.length === 0) {\r\n      return null\r\n    }\r\n    const coverImage = property.propertyImages.find((img) => img.cover)\r\n    return coverImage ? coverImage.url : property.propertyImages[0].url\r\n  }\r\n\r\n  // Helper function to build full image URL\r\n  const getImageUrl = (url: string | null | undefined) => {\r\n    if (!url) return \"/placeholder.jpg\"\r\n    if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) {\r\n      return url\r\n    }\r\n    if (url.startsWith(\"/uploads\")) {\r\n      return `http://localhost:8081${url}`\r\n    }\r\n    return url\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"h-12 w-12 animate-spin text-teal-600 mx-auto mb-4\" />\r\n          <p className=\"text-gray-600\">Loading booking details...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error && !booking) {\r\n    return (\r\n      <div className=\"min-h-screen flex flex-col items-center justify-center bg-gray-50\">\r\n        <Card className=\"p-8 text-center max-w-md\">\r\n          <AlertCircle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\r\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Error</h2>\r\n          <p className=\"text-gray-600 mb-6\">{error}</p>\r\n          <Link href=\"/my-bookings\">\r\n            <Button variant=\"outline\">Back to Bookings</Button>\r\n          </Link>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!booking) {\r\n    return (\r\n      <div className=\"min-h-screen flex flex-col items-center justify-center bg-gray-50\">\r\n        <Card className=\"p-8 text-center max-w-md\">\r\n          <XCircle className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\r\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Booking Not Found</h2>\r\n          <p className=\"text-gray-600 mb-6\">The booking you're looking for doesn't exist.</p>\r\n          <Link href=\"/my-bookings\">\r\n            <Button variant=\"outline\">Back to Bookings</Button>\r\n          </Link>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const nights = calculateNights(booking.checkInDate, booking.checkOutDate)\r\n  const imageUrl = getPropertyImage(property)\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50\">\r\n      <div className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\r\n        {/* Back Button */}\r\n        <Link href=\"/my-bookings\">\r\n          <Button variant=\"ghost\" className=\"mb-6\">\r\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n            Back to Bookings\r\n          </Button>\r\n        </Link>\r\n\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">Booking #{booking.id}</h1>\r\n          <div className=\"flex items-center gap-4\">\r\n            {getStatusBadge(booking.status)}\r\n            {booking.onChainTxHash && (\r\n              <Badge variant=\"outline\" className=\"text-xs\">\r\n                Transaction: {booking.onChainTxHash.substring(0, 10)}...\r\n              </Badge>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {error && (\r\n          <Card className=\"p-4 mb-6 border-red-200 bg-red-50\">\r\n            <p className=\"text-red-700 text-sm\">{error}</p>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Property Image Section */}\r\n        {property && imageUrl && (\r\n          <Card className=\"mb-6 overflow-hidden\">\r\n            <div className=\"relative h-64 bg-gradient-to-br from-teal-100 to-teal-200\">\r\n              <Image\r\n                src={getImageUrl(imageUrl)}\r\n                alt={property.title || \"Property\"}\r\n                fill\r\n                className=\"object-cover\"\r\n                sizes=\"(max-width: 768px) 100vw, 80vw\"\r\n              />\r\n            </div>\r\n            <div className=\"p-6\">\r\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{property.title}</h2>\r\n              {property.address && (\r\n                <div className=\"flex items-center text-gray-600\">\r\n                  <MapPin className=\"w-4 h-4 mr-2 text-teal-600\" />\r\n                  <span>{property.address.city}, {property.address.country}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Main Content */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          {/* Left Column - Main Details */}\r\n          <div className=\"lg:col-span-2 space-y-6\">\r\n            {!isEditing ? (\r\n              <>\r\n                {/* Basic Information */}\r\n                <Card className=\"p-6\">\r\n                  <h2 className=\"text-xl font-semibold text-gray-900 mb-4 flex items-center\">\r\n                    <Calendar className=\"w-5 h-5 mr-2 text-teal-600\" />\r\n                    Booking Dates\r\n                  </h2>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                      <span className=\"text-sm font-medium text-gray-600\">Check-in Date</span>\r\n                      <span className=\"text-sm font-semibold text-gray-900\">\r\n                        {formatDate(booking.checkInDate)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                      <span className=\"text-sm font-medium text-gray-600\">Check-out Date</span>\r\n                      <span className=\"text-sm font-semibold text-gray-900\">\r\n                        {formatDate(booking.checkOutDate)}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center py-3\">\r\n                      <span className=\"text-sm font-medium text-gray-600 flex items-center\">\r\n                        <Clock className=\"w-4 h-4 mr-2 text-teal-600\" />\r\n                        Duration\r\n                      </span>\r\n                      <span className=\"text-sm font-semibold text-gray-900\">\r\n                        {nights} {nights === 1 ? \"night\" : \"nights\"}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n\r\n                {/* Pricing Information */}\r\n                <Card className=\"p-6\">\r\n                  <h2 className=\"text-xl font-semibold text-gray-900 mb-4 flex items-center\">\r\n                    <DollarSign className=\"w-5 h-5 mr-2 text-teal-600\" />\r\n                    Pricing Details\r\n                  </h2>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                      <span className=\"text-sm font-medium text-gray-600\">Total Price</span>\r\n                      <span className=\"text-2xl font-bold text-teal-600\">\r\n                        {booking.totalPrice?.toFixed(4) || \"N/A\"} ETH\r\n                      </span>\r\n                    </div>\r\n                    {booking.longStayDiscountPercent && booking.longStayDiscountPercent > 0 && (\r\n                      <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                        <span className=\"text-sm font-medium text-gray-600\">Long Stay Discount</span>\r\n                        <span className=\"text-sm font-semibold text-blue-600\">\r\n                          {booking.longStayDiscountPercent}%\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                    {booking.requestedNegotiationPercent && booking.requestedNegotiationPercent > 0 && (\r\n                      <div className=\"flex justify-between items-center py-3\">\r\n                        <span className=\"text-sm font-medium text-gray-600\">Negotiation</span>\r\n                        <span className=\"text-sm font-semibold text-yellow-600\">\r\n                          {booking.requestedNegotiationPercent}%\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </Card>\r\n\r\n                {/* Booking Information */}\r\n                <Card className=\"p-6\">\r\n                  <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Booking Information</h2>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                      <span className=\"text-sm font-medium text-gray-600\">Booking ID</span>\r\n                      <span className=\"text-sm font-semibold text-gray-900\">#{booking.id}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center py-3 border-b border-gray-200\">\r\n                      <span className=\"text-sm font-medium text-gray-600\">Property ID</span>\r\n                      <span className=\"text-sm font-semibold text-gray-900\">{booking.propertyId}</span>\r\n                    </div>\r\n                    {booking.createdAt && (\r\n                      <div className=\"flex justify-between items-center py-3\">\r\n                        <span className=\"text-sm font-medium text-gray-600\">Created At</span>\r\n                        <span className=\"text-sm text-gray-900\">{formatDate(booking.createdAt)}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </Card>\r\n              </>\r\n            ) : (\r\n              /* Edit Form */\r\n              <Card className=\"p-6\">\r\n                <h2 className=\"text-xl font-semibold text-gray-900 mb-6\">Edit Booking</h2>\r\n                <div className=\"space-y-6\">\r\n                  {/* Check-in Date */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Check-in Date *\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={editForm.checkInDate}\r\n                      onChange={(e) => setEditForm({ ...editForm, checkInDate: e.target.value })}\r\n                      min={new Date().toISOString().split(\"T\")[0]}\r\n                      className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Check-out Date */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Check-out Date *\r\n                    </label>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={editForm.checkOutDate}\r\n                      onChange={(e) => setEditForm({ ...editForm, checkOutDate: e.target.value })}\r\n                      min={editForm.checkInDate || new Date().toISOString().split(\"T\")[0]}\r\n                      className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Number of Guests */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Number of Guests\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      min=\"1\"\r\n                      value={editForm.numberOfGuests}\r\n                      onChange={(e) => setEditForm({ ...editForm, numberOfGuests: parseInt(e.target.value) || 1 })}\r\n                      className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600\"\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Price Info */}\r\n                  {basePrice && (\r\n                    <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                      <p className=\"text-sm text-blue-800\">\r\n                        <strong>Base Price:</strong> {basePrice.toFixed(4)} ETH\r\n                      </p>\r\n                      {propertyInfo?.negotiationPercentage && propertyInfo.negotiationPercentage > 0 && (\r\n                        <p className=\"text-sm text-blue-800 mt-1\">\r\n                          <strong>Min Negotiation:</strong>{\" \"}\r\n                          {(basePrice * (1 - propertyInfo.negotiationPercentage / 100)).toFixed(4)} ETH\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Requested Price */}\r\n                  {propertyInfo?.negotiationPercentage && propertyInfo.negotiationPercentage > 0 && (\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        Requested Price (ETH) - Leave empty for full price\r\n                      </label>\r\n                      <input\r\n                        type=\"number\"\r\n                        step=\"0.001\"\r\n                        min={basePrice ? (basePrice * (1 - propertyInfo.negotiationPercentage / 100)).toFixed(4) : 0}\r\n                        max={basePrice?.toFixed(4)}\r\n                        value={editForm.requestedPrice}\r\n                        onChange={(e) => setEditForm({ ...editForm, requestedPrice: e.target.value })}\r\n                        placeholder={basePrice ? `Enter price (min: ${(basePrice * (1 - propertyInfo.negotiationPercentage / 100)).toFixed(4)} ETH)` : \"\"}\r\n                        className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600\"\r\n                      />\r\n                      {basePrice && editForm.requestedPrice && (\r\n                        <p className=\"text-xs mt-1 text-gray-600\">\r\n                          {parseFloat(editForm.requestedPrice) >= basePrice\r\n                            ? \"✅ Full price - negotiation will be cancelled\"\r\n                            : parseFloat(editForm.requestedPrice) >= basePrice * (1 - propertyInfo.negotiationPercentage / 100)\r\n                            ? \"✅ Valid negotiation price\"\r\n                            : \"⚠️ Price below minimum allowed\"}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Form Actions */}\r\n                  <div className=\"flex gap-3 pt-4\">\r\n                    <Button\r\n                      onClick={handleUpdate}\r\n                      disabled={actionLoading}\r\n                      className=\"flex-1 bg-teal-600 hover:bg-teal-700 text-white\"\r\n                    >\r\n                      {actionLoading ? (\r\n                        <>\r\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                          Saving...\r\n                        </>\r\n                      ) : (\r\n                        \"Save Changes\"\r\n                      )}\r\n                    </Button>\r\n                    <Button\r\n                      onClick={handleCancelEdit}\r\n                      disabled={actionLoading}\r\n                      variant=\"outline\"\r\n                      className=\"flex-1\"\r\n                    >\r\n                      Cancel\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            )}\r\n          </div>\r\n\r\n          {/* Right Column - Actions */}\r\n          <div className=\"space-y-6\">\r\n            {/* Action Buttons */}\r\n            {!isEditing && (\r\n              <Card className=\"p-6\">\r\n                <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">Actions</h2>\r\n                <div className=\"space-y-3\">\r\n                  {/* Edit Button */}\r\n                  {(booking.status === \"PENDING\" || \r\n                    booking.status === \"PENDING_PAYMENT\" || \r\n                    booking.status === \"PENDING_NEGOTIATION\") && (\r\n                    <Button\r\n                      onClick={handleEdit}\r\n                      disabled={actionLoading}\r\n                      variant=\"outline\"\r\n                      className=\"w-full\"\r\n                    >\r\n                      <Edit className=\"w-4 h-4 mr-2\" />\r\n                      Edit Booking\r\n                    </Button>\r\n                  )}\r\n\r\n                  {/* Pay Button */}\r\n                  {(booking.status === \"PENDING_PAYMENT\" || \r\n                    (booking.status === \"PENDING\" && !booking.requestedNegotiationPercent)) && (\r\n                    <Button\r\n                      onClick={() => router.push(`/payment?bookingId=${booking.id}`)}\r\n                      className=\"w-full bg-teal-600 hover:bg-teal-700 text-white\"\r\n                    >\r\n                      <CreditCard className=\"w-4 h-4 mr-2\" />\r\n                      Pay Now\r\n                    </Button>\r\n                  )}\r\n\r\n                  {/* Checkout Button */}\r\n                  {booking.status === \"CONFIRMED\" && (\r\n                    <Button\r\n                      onClick={async () => {\r\n                        if (!window.confirm(\"Are you sure you have checked out?\")) return\r\n                        setActionLoading(true)\r\n                        try {\r\n                          await apiClient.bookings.markAsCheckedOut(booking.id, parseInt(user!.id))\r\n                          await fetchBooking()\r\n                        } catch (err: any) {\r\n                          setError(err.message || \"Failed to confirm checkout\")\r\n                        } finally {\r\n                          setActionLoading(false)\r\n                        }\r\n                      }}\r\n                      disabled={actionLoading}\r\n                      className=\"w-full bg-green-600 hover:bg-green-700 text-white\"\r\n                    >\r\n                      {actionLoading ? (\r\n                        <>\r\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                          Processing...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n                          I've Checked Out\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  )}\r\n\r\n                  {/* Delete Button */}\r\n                  {(booking.status === \"PENDING\" || \r\n                    booking.status === \"PENDING_PAYMENT\" || \r\n                    booking.status === \"PENDING_NEGOTIATION\") && (\r\n                    <Button\r\n                      onClick={handleDelete}\r\n                      disabled={actionLoading}\r\n                      variant=\"destructive\"\r\n                      className=\"w-full\"\r\n                    >\r\n                      {actionLoading ? (\r\n                        <>\r\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                          Deleting...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                          Cancel Booking\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Quick Info */}\r\n            <Card className=\"p-6 bg-teal-50 border-teal-200\">\r\n              <h3 className=\"text-sm font-semibold text-teal-900 mb-3\">Quick Info</h3>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-teal-700\">Status:</span>\r\n                  <span className=\"font-medium text-teal-900\">{booking.status}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-teal-700\">Nights:</span>\r\n                  <span className=\"font-medium text-teal-900\">{nights}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-teal-700\">Total:</span>\r\n                  <span className=\"font-medium text-teal-900\">\r\n                    {booking.totalPrice?.toFixed(4) || \"N/A\"} ETH\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n"],"names":[],"mappings":"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"}