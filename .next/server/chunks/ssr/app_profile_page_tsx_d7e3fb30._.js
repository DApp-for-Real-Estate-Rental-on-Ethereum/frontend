module.exports=[65066,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(13216),e=a.i(50944),f=a.i(38246),g=a.i(71987),h=a.i(40695),i=a.i(3130),j=a.i(5522),k=a.i(17171),l=a.i(65733);let m=(0,a.i(70106).default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var n=a.i(33508),o=a.i(77156),p=a.i(41379),q=a.i(96221),r=a.i(72211);function s(){let a,s,{user:t,login:u}=(0,d.useAuth)();(0,e.useRouter)();let[v,w]=(0,c.useState)({firstName:"",lastName:"",email:"",phoneNumber:"",birthday:"",walletAddress:"",profilePicture:""}),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{if(!t)return y(!1);try{y(!0);let a=await r.apiClient.users.getMe(),b=a.walletAddress||null;null!=b&&(b=b.trim(),""===b&&(b=null)),w({firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",phoneNumber:a.phoneNumber?.toString()||"",birthday:a.birthday||"",walletAddress:b||"",profilePicture:a.profilePicture||""})}catch(a){w({firstName:t.firstName||"",lastName:t.lastName||"",email:t.email||"",phoneNumber:t.phoneNumber||"",birthday:t.birthday||"",walletAddress:"",profilePicture:t.profileImage||""})}finally{y(!1)}})()},[t]);let R=a=>{let{name:b,value:c}=a.target;w(a=>({...a,[b]:c}))},S=async()=>{if(t){A(!0),C(""),E("");try{let a={};if(v.firstName&&(a.firstName=v.firstName),v.lastName&&(a.lastName=v.lastName),v.birthday&&(a.birthday=v.birthday),v.phoneNumber){let b=v.phoneNumber.replace(/\D/g,"");if(b.length>=10&&b.length<=15)a.phoneNumber=b;else throw Error("Phone number must be 10 to 15 digits")}if(v.walletAddress)if(/^0x[a-fA-F0-9]{40}$/.test(v.walletAddress))a.walletAddress=v.walletAddress;else throw Error("Wallet address must be a valid Ethereum address (0x followed by 40 hex characters)");await r.apiClient.users.updateMe(a),E("Profile updated successfully!");let b=await r.apiClient.users.getMe();w(a=>({...a,firstName:b.firstName||a.firstName,lastName:b.lastName||a.lastName,phoneNumber:b.phoneNumber?.toString()||a.phoneNumber,birthday:b.birthday||a.birthday,profilePicture:b.profilePicture||a.profilePicture}))}catch(a){C(a instanceof Error?a.message:"Failed to update profile. Please try again.")}finally{A(!1)}}},T=async a=>{let b=a.target.files?.[0];if(b&&t){A(!0),C(""),E("");try{let a=(await r.apiClient.users.updateProfilePicture(b)).url;w(b=>({...b,profilePicture:a}));try{let b=await r.apiClient.users.getMe(),c={...t,profileImage:b.profilePicture||a};localStorage.setItem("user",JSON.stringify(c)),localStorage.setItem("derent5_user_data",JSON.stringify(c)),window.dispatchEvent(new Event("auth-state-changed"))}catch(c){let b={...t,profileImage:a};localStorage.setItem("user",JSON.stringify(b)),localStorage.setItem("derent5_user_data",JSON.stringify(b)),window.dispatchEvent(new Event("auth-state-changed"))}E("Profile picture updated successfully!")}catch(a){C(a instanceof Error?a.message:"Failed to update profile picture. Please try again.")}finally{A(!1)}}},U=async()=>{if(t&&confirm("Are you sure you want to delete your profile picture?")){A(!0),C(""),E("");try{await r.apiClient.users.deleteProfilePicture(),w(a=>({...a,profilePicture:""}));let a={...t,profileImage:void 0};localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("derent5_user_data",JSON.stringify(a)),window.dispatchEvent(new Event("auth-state-changed")),E("Profile picture deleted successfully!")}catch(a){C(a instanceof Error?a.message:"Failed to delete profile picture. Please try again.")}finally{A(!1)}}},V=async()=>{if(t)return void C("MetaMask is not installed. Please install MetaMask extension to connect your wallet.")},W=async()=>{if(t&&confirm("Are you sure you want to disconnect your wallet?")){A(!0),C(""),E("");try{await r.apiClient.users.updateMe({walletAddress:""}),w(a=>({...a,walletAddress:""})),E("Wallet disconnected successfully!");let a=await r.apiClient.users.getMe();w(b=>({...b,walletAddress:a.walletAddress||""}))}catch(a){C(a instanceof Error?a.message:"Failed to disconnect wallet. Please try again.")}finally{A(!1)}}};return t?x?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsx)(i.Card,{className:"p-8 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"Loading profile..."})})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"})}),(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(i.Card,{className:"p-8",children:(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative",children:[v.profilePicture?(0,b.jsx)("div",{className:"relative w-24 h-24 rounded-full overflow-hidden border-4 border-teal-600",children:(0,b.jsx)(g.default,{src:(a=v.profilePicture)?a.startsWith("http://")||a.startsWith("https://")?a:a.startsWith("/profile-pictures")||a.startsWith("/user-images")||a.startsWith("/")?`http://localhost:8082${a}`:a:"/placeholder.jpg",alt:`${t.firstName} ${t.lastName}`,fill:!0,className:"object-cover",sizes:"96px"})}):(0,b.jsx)("div",{className:"w-24 h-24 bg-gray-900 rounded-full flex items-center justify-center text-white text-4xl font-bold",children:t.firstName?.charAt(0)||t.lastName?.charAt(0)||"A"}),(0,b.jsxs)("label",{className:"absolute bottom-0 right-0 bg-teal-600 text-white p-2 rounded-full hover:bg-teal-700 cursor-pointer",children:[(0,b.jsx)(m,{className:"w-4 h-4"}),(0,b.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png",onChange:T,className:"hidden"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[t.firstName," ",t.lastName]}),(0,b.jsx)("p",{className:"text-gray-600",children:t.email}),(0,b.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,b.jsxs)("label",{className:"cursor-pointer",children:[(0,b.jsx)(h.Button,{type:"button",className:"bg-teal-600 hover:bg-teal-700",asChild:!0,children:(0,b.jsx)("span",{children:"Change profile picture"})}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:T,className:"hidden"})]}),v.profilePicture&&(0,b.jsxs)(h.Button,{type:"button",variant:"outline",onClick:U,className:"border-red-600 text-red-600 hover:bg-red-50",disabled:z,children:[(0,b.jsx)(n.X,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})}),D&&(0,b.jsx)("div",{className:"p-4 bg-green-50 text-green-700 rounded-lg",children:D}),B&&(0,b.jsx)("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg",children:B}),(0,b.jsxs)(i.Card,{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Personal Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First name"}),(0,b.jsx)("input",{type:"text",name:"firstName",value:v.firstName,onChange:R,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last name"}),(0,b.jsx)("input",{type:"text",name:"lastName",value:v.lastName,onChange:R,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600"})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone number"}),(0,b.jsx)("input",{type:"tel",name:"phoneNumber",value:v.phoneNumber,onChange:R,placeholder:"212612345678",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"10-15 digits only"})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Birthday"}),(0,b.jsx)("input",{type:"date",name:"birthday",value:v.birthday,onChange:R,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600"})]})]}),(0,b.jsx)(h.Button,{onClick:S,className:"mt-6 bg-teal-600 hover:bg-teal-700",disabled:z,children:z?"Saving...":"Save changes"})]}),(0,b.jsxs)(i.Card,{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Security"}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,b.jsx)("input",{type:"email",name:"email",value:v.email,onChange:R,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-600"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,b.jsx)(h.Button,{type:"button",onClick:()=>G(!0),className:"w-full bg-teal-600 hover:bg-teal-700",children:"Change password"})]})]})]}),(0,b.jsxs)(i.Card,{className:"p-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Payment"}),null==(s=v.walletAddress)||void 0===s||""===s.trim()?(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wallet Address"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Connect your MetaMask wallet to enable cryptocurrency payments"}),(0,b.jsx)(h.Button,{onClick:V,className:"bg-teal-600 hover:bg-teal-700",disabled:z,children:z?"Connecting...":"Connect Wallet"})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wallet Address"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("input",{type:"text",value:v.walletAddress,readOnly:!0,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700"}),(0,b.jsx)(h.Button,{onClick:W,variant:"outline",className:"border-red-600 text-red-600 hover:bg-red-50",disabled:z,children:z?"Disconnecting...":"Disconnect Wallet"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Your wallet is connected. You can use it for cryptocurrency payments."})]})]}),(0,b.jsxs)(i.Card,{className:"p-8 border-red-200",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-red-600 mb-4",children:"Danger Zone"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Once you delete your account, there is no going back. Please be certain."}),v.profilePicture&&(0,b.jsx)(h.Button,{variant:"outline",onClick:U,className:"border-red-600 text-red-600 hover:bg-red-50",disabled:z,children:z?"Deleting...":"Delete profile picture"})]})]})]}),(0,b.jsx)(l.Dialog,{open:F,onOpenChange:G,children:(0,b.jsxs)(l.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"Change Password"}),(0,b.jsx)(l.DialogDescription,{children:"Enter your current password and choose a new password"})]}),(0,b.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),C(""),!H.currentPassword||!H.newPassword||!H.confirmPassword)return void C("Please fill in all fields");if(H.newPassword!==H.confirmPassword)return void C("New passwords do not match");if(!/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=!]).{8,20}$/.test(H.newPassword))return void C("Password must be 8-20 characters long and include at least one uppercase letter, one lowercase letter, one number, and one special character (@#$%^&+=!)");Q(!0),C("");try{await r.apiClient.users.changePassword(H.currentPassword,H.newPassword),E("Password changed successfully!"),G(!1),I({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>E(""),3e3)}catch(a){C(a.message||"Failed to change password. Please check your current password and try again.")}finally{Q(!1)}},className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{htmlFor:"currentPassword",children:"Current Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"currentPassword",type:J?"text":"password",value:H.currentPassword,onChange:a=>I(b=>({...b,currentPassword:a.target.value})),className:"pr-10",required:!0}),(0,b.jsx)("button",{type:"button",onClick:()=>K(!J),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:J?(0,b.jsx)(p.EyeOff,{className:"w-4 h-4"}):(0,b.jsx)(o.Eye,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{htmlFor:"newPassword",children:"New Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"newPassword",type:L?"text":"password",value:H.newPassword,onChange:a=>I(b=>({...b,newPassword:a.target.value})),className:"pr-10",required:!0}),(0,b.jsx)("button",{type:"button",onClick:()=>M(!L),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:L?(0,b.jsx)(p.EyeOff,{className:"w-4 h-4"}):(0,b.jsx)(o.Eye,{className:"w-4 h-4"})})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"8-20 characters, include uppercase, lowercase, number, and special character"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j.Input,{id:"confirmPassword",type:N?"text":"password",value:H.confirmPassword,onChange:a=>I(b=>({...b,confirmPassword:a.target.value})),className:"pr-10",required:!0}),(0,b.jsx)("button",{type:"button",onClick:()=>O(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:N?(0,b.jsx)(p.EyeOff,{className:"w-4 h-4"}):(0,b.jsx)(o.Eye,{className:"w-4 h-4"})})]})]}),B&&(0,b.jsx)("div",{className:"p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:B}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>{G(!1),I({currentPassword:"",newPassword:"",confirmPassword:""}),C("")},className:"flex-1",children:"Cancel"}),(0,b.jsx)(h.Button,{type:"submit",className:"flex-1 bg-teal-600 hover:bg-teal-700",disabled:P,children:P?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Changing..."]}):"Change Password"})]})]})]})})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,b.jsxs)(i.Card,{className:"p-8 text-center",children:[(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Please sign in to view your profile"}),(0,b.jsx)(f.default,{href:"/login",children:(0,b.jsx)(h.Button,{className:"bg-teal-600 hover:bg-teal-700",children:"Sign In"})})]})})}a.s(["default",()=>s],65066)}];

//# sourceMappingURL=app_profile_page_tsx_d7e3fb30._.js.map