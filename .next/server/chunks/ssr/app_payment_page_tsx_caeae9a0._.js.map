{"version":3,"sources":["../../../../app/payment/page.tsx","../../../../node_modules/lucide-react/src/icons/wallet.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\"\r\nimport { useSearchParams, useRouter } from \"next/navigation\"\r\nimport { ethers } from \"ethers\"\r\nimport { apiClient } from \"@/lib/services/api\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card } from \"@/components/ui/card\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport { ArrowLeft, Wallet, Loader2, Calendar, User, AlertCircle } from \"lucide-react\"\r\nimport { useAuth } from \"@/lib/hooks/use-auth\"\r\nimport { toast } from \"sonner\"\r\n\r\nconst HARDHAT_CHAIN_ID = \"0x7a69\"\r\nconst ARBITRUM_ONE_CHAIN_ID = \"0xa4b1\"\r\n\r\ndeclare global {\r\n  interface Window {\r\n    ethereum?: any\r\n  }\r\n}\r\n\r\ninterface BookingDetails {\r\n  bookingId: number\r\n  totalPrice: number\r\n  propertyPrice: number\r\n  checkInDate: string\r\n  checkOutDate: string\r\n  userWalletAddress: string\r\n  ownerWalletAddress: string\r\n  currentUserId: number\r\n  userId: number\r\n  propertyTitle: string\r\n  status: string\r\n  userFirstName: string\r\n  userLastName: string\r\n  userEmail: string\r\n}\r\n\r\ninterface PaymentIntentData {\r\n  to: string\r\n  value: string | number | bigint\r\n  data?: string\r\n  chainId?: string | number\r\n}\r\n\r\nexport default function PaymentPage() {\r\n  const searchParams = useSearchParams()\r\n  const router = useRouter()\r\n  const { user } = useAuth()\r\n\r\n  const [bookingId, setBookingId] = useState<number | null>(null)\r\n  const [walletAddress, setWalletAddress] = useState(\"\")\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const [bookingDetails, setBookingDetails] = useState<BookingDetails | null>(null)\r\n  const [loadingDetails, setLoadingDetails] = useState(false)\r\n  const [walletBalance, setWalletBalance] = useState<number | null>(null)\r\n  const [gasEstimate] = useState(0.0001)\r\n  const [networkName, setNetworkName] = useState(\"Not connected\")\r\n  const [isCorrectNetwork, setIsCorrectNetwork] = useState(false)\r\n\r\n  useEffect(() => {\r\n    const id = searchParams.get(\"bookingId\") || searchParams.get(\"id\")\r\n    if (id) {\r\n      const bookingIdNum = parseInt(id, 10)\r\n      if (!isNaN(bookingIdNum) && bookingIdNum > 0) {\r\n        setBookingId(bookingIdNum)\r\n        fetchBookingDetails(bookingIdNum)\r\n      } else {\r\n        setError(\"Invalid booking ID in URL. Please use a valid number.\")\r\n      }\r\n    } else {\r\n      setError(\"Booking ID is required in URL. Please add ?bookingId=1 to the URL.\")\r\n    }\r\n  }, [searchParams])\r\n\r\n  useEffect(() => {\r\n    const addressToCheck = walletAddress || bookingDetails?.userWalletAddress\r\n    if (addressToCheck && typeof window !== \"undefined\" && window.ethereum) {\r\n      const timeoutId = setTimeout(() => {\r\n        checkWalletInfo(addressToCheck)\r\n      }, 500)\r\n      return () => clearTimeout(timeoutId)\r\n    }\r\n  }, [bookingDetails?.userWalletAddress, walletAddress])\r\n\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return\r\n    const ethereum = window.ethereum\r\n    if (ethereum && typeof ethereum.on === \"function\") {\r\n      const handleChainChanged = async (chainId: string) => {\r\n        if (chainId === HARDHAT_CHAIN_ID || chainId === ARBITRUM_ONE_CHAIN_ID) {\r\n          setIsCorrectNetwork(true)\r\n          setNetworkName(chainId === HARDHAT_CHAIN_ID ? \"Hardhat Local\" : \"Arbitrum One\")\r\n        } else {\r\n          setIsCorrectNetwork(false)\r\n          setNetworkName(\"Wrong Network\")\r\n        }\r\n        const addressToCheck = walletAddress || bookingDetails?.userWalletAddress || \"\"\r\n        if (addressToCheck) {\r\n          await checkWalletInfo(addressToCheck)\r\n        }\r\n      }\r\n      ethereum.on(\"chainChanged\", handleChainChanged)\r\n      return () => {\r\n        if (typeof ethereum.removeListener === \"function\") {\r\n          ethereum.removeListener(\"chainChanged\", handleChainChanged)\r\n        }\r\n      }\r\n    }\r\n  }, [walletAddress, bookingDetails])\r\n\r\n  async function fetchBookingDetails(id: number) {\r\n    try {\r\n      setLoadingDetails(true)\r\n      setError(null)\r\n      const data = await apiClient.payments.getBookingDetails(id)\r\n      if (!data.ownerWalletAddress || data.ownerWalletAddress === \"null\" || data.ownerWalletAddress === \"N/A\" || data.ownerWalletAddress === \"\") {\r\n        throw new Error(\"Owner wallet address is missing\")\r\n      }\r\n      if (!data.totalPrice || data.totalPrice <= 0) {\r\n        throw new Error(\"Booking total price is missing or invalid\")\r\n      }\r\n      setBookingDetails(data)\r\n      setError(null)\r\n    } catch (e: any) {\r\n      const errorMessage = e.message || \"An unexpected error occurred\"\r\n      setError(`Failed to load booking details: ${errorMessage}`)\r\n    } finally {\r\n      setLoadingDetails(false)\r\n    }\r\n  }\r\n\r\n  async function switchToNetwork(chainId: string, chainName: string, rpcUrl: string) {\r\n    if (typeof window === \"undefined\" || !window.ethereum) return\r\n    const ethereum = window.ethereum\r\n    try {\r\n      await ethereum.request({\r\n        method: \"wallet_switchEthereumChain\",\r\n        params: [{ chainId }],\r\n      })\r\n    } catch (switchError: any) {\r\n      if (switchError.code === 4902) {\r\n        await ethereum.request({\r\n          method: \"wallet_addEthereumChain\",\r\n          params: [\r\n            {\r\n              chainId,\r\n              chainName,\r\n              nativeCurrency: { name: \"ETH\", symbol: \"ETH\", decimals: 18 },\r\n              rpcUrls: [rpcUrl],\r\n              blockExplorerUrls: chainId === ARBITRUM_ONE_CHAIN_ID ? [\"https://arbiscan.io\"] : [],\r\n            },\r\n          ],\r\n        })\r\n      } else {\r\n        throw switchError\r\n      }\r\n    }\r\n  }\r\n\r\n  async function connectWallet() {\r\n    try {\r\n      if (typeof window === \"undefined\" || !window.ethereum) {\r\n        toast.error(\"MetaMask is not available. Please install it first.\")\r\n        return\r\n      }\r\n      const ethereum = window.ethereum\r\n      const currentChainId = await ethereum.request({ method: \"eth_chainId\" })\r\n      if (currentChainId !== HARDHAT_CHAIN_ID && currentChainId !== ARBITRUM_ONE_CHAIN_ID) {\r\n        try {\r\n          await switchToNetwork(HARDHAT_CHAIN_ID, \"Hardhat Local\", \"http://127.0.0.1:8545\")\r\n        } catch {\r\n          await switchToNetwork(ARBITRUM_ONE_CHAIN_ID, \"Arbitrum One\", \"https://arb1.arbitrum.io/rpc\")\r\n        }\r\n      }\r\n      const accounts = (await ethereum.request({ method: \"eth_requestAccounts\" })) as string[]\r\n      const addr = accounts?.[0] || \"\"\r\n      if (!addr) {\r\n        toast.error(\"No account selected. Please select an account in MetaMask.\")\r\n        return\r\n      }\r\n      if (!ethers.isAddress(addr)) {\r\n        toast.error(\"Invalid wallet address format\")\r\n        return\r\n      }\r\n      const normalizedAddr = ethers.getAddress(addr)\r\n      setWalletAddress(normalizedAddr)\r\n      if (bookingDetails?.currentUserId && addr) {\r\n        await saveWalletAddressToDatabase(bookingDetails.currentUserId, addr)\r\n      }\r\n      await checkWalletInfo(addr)\r\n      toast.success(\"Wallet connected successfully\")\r\n    } catch (e: any) {\r\n      toast.error(`Failed to connect wallet: ${e.message}`)\r\n    }\r\n  }\r\n\r\n  async function checkWalletInfo(address: string) {\r\n    try {\r\n      if (typeof window === \"undefined\" || !window.ethereum || !address) return\r\n      const ethereum = window.ethereum\r\n      const chainId = await ethereum.request({ method: \"eth_chainId\" })\r\n      if (chainId === HARDHAT_CHAIN_ID) {\r\n        setNetworkName(\"Hardhat Local\")\r\n        setIsCorrectNetwork(true)\r\n      } else if (chainId === ARBITRUM_ONE_CHAIN_ID) {\r\n        setNetworkName(\"Arbitrum One\")\r\n        setIsCorrectNetwork(true)\r\n      } else {\r\n        setNetworkName(\"Wrong Network\")\r\n        setIsCorrectNetwork(false)\r\n      }\r\n      const provider = new ethers.BrowserProvider(ethereum)\r\n      if (!ethers.isAddress(address)) {\r\n        throw new Error(`Invalid Ethereum address: ${address}`)\r\n      }\r\n      const checksumAddress = ethers.getAddress(address)\r\n      const balance = await provider.getBalance(checksumAddress)\r\n      if (!balance) {\r\n        throw new Error(\"Balance is null or undefined\")\r\n      }\r\n      const balanceInEth = parseFloat(ethers.formatEther(balance))\r\n      if (isNaN(balanceInEth) || !isFinite(balanceInEth)) {\r\n        throw new Error(`Invalid balance conversion result: ${balanceInEth}`)\r\n      }\r\n      setWalletBalance(balanceInEth)\r\n    } catch (e: any) {\r\n      setNetworkName(\"Error: \" + (e.message || \"Unknown error\"))\r\n      setIsCorrectNetwork(false)\r\n      setWalletBalance(null)\r\n      toast.error(`Failed to check wallet balance: ${e.message || \"Unknown error\"}`)\r\n    }\r\n  }\r\n\r\n  async function saveWalletAddressToDatabase(userId: number, address: string) {\r\n    try {\r\n      await apiClient.payments.updateWalletAddress(userId, address)\r\n      if (bookingId) {\r\n        await fetchBookingDetails(bookingId)\r\n      }\r\n    } catch {\r\n      return\r\n    }\r\n  }\r\n\r\n  async function saveTransactionHash(id: number, txHash: string) {\r\n    try {\r\n      await apiClient.payments.updateTransactionHash(id, txHash)\r\n      toast.success(\"Transaction hash saved successfully\")\r\n    } catch {\r\n      return\r\n    }\r\n  }\r\n\r\n  function validateForm(): boolean {\r\n    if (!bookingDetails || !bookingId) return false\r\n    const hasWallet = walletAddress || bookingDetails.userWalletAddress\r\n    if (!hasWallet) return false\r\n    if (!bookingDetails.ownerWalletAddress || bookingDetails.ownerWalletAddress === \"N/A\") return false\r\n    if (!networkName || networkName === \"Not connected\") return false\r\n    if (!isCorrectNetwork) return false\r\n    const totalPrice = bookingDetails.totalPrice || 0\r\n    if (!totalPrice || totalPrice <= 0) return false\r\n    if (gasEstimate === null || gasEstimate === undefined) return false\r\n    if (walletBalance === null || walletBalance === undefined) return false\r\n    const totalNeeded = totalPrice + gasEstimate\r\n    if (walletBalance < totalNeeded) return false\r\n    if (typeof window === \"undefined\" || !window.ethereum) return false\r\n    return true\r\n  }\r\n\r\n  const formValid = useMemo(\r\n    () => validateForm(),\r\n    [bookingDetails, bookingId, walletAddress, networkName, isCorrectNetwork, walletBalance, gasEstimate]\r\n  )\r\n\r\n  async function createPaymentIntent() {\r\n    if (!bookingId) {\r\n      toast.error(\"Booking ID is required\")\r\n      return\r\n    }\r\n    if (!walletAddress && !bookingDetails?.userWalletAddress) {\r\n      toast.error(\"Please connect MetaMask first\")\r\n      return\r\n    }\r\n    try {\r\n      setLoading(true)\r\n      const data = await apiClient.payments.createIntent(bookingId)\r\n      await sendMetaMaskTransaction(data)\r\n    } catch (e: any) {\r\n      const errorMessage = e?.message || e?.toString() || \"Unknown error\"\r\n      toast.error(`Failed to create payment intent: ${errorMessage}`)\r\n      setError(errorMessage)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  async function sendMetaMaskTransaction(intentData: PaymentIntentData) {\r\n    try {\r\n      if (typeof window === \"undefined\" || !window.ethereum) {\r\n        toast.error(\"MetaMask is not installed. Please install MetaMask extension.\")\r\n        return\r\n      }\r\n      if (!intentData.to) {\r\n        toast.error(\"Contract address not found in payment intent.\")\r\n        return\r\n      }\r\n      if (!intentData.value) {\r\n        toast.error(\"Payment amount not found in payment intent.\")\r\n        return\r\n      }\r\n      let accounts: string[] = []\r\n      try {\r\n        accounts = (await window.ethereum.request({\r\n          method: \"eth_requestAccounts\",\r\n        })) as string[]\r\n      } catch (requestError: any) {\r\n        if (requestError.code === 4001) {\r\n          toast.error(\"Please approve the connection request in MetaMask to continue.\")\r\n          throw new Error(\"User rejected MetaMask connection request\")\r\n        } else {\r\n          toast.error(`Failed to connect to MetaMask: ${requestError.message || \"Unknown error\"}`)\r\n          throw new Error(`MetaMask connection failed: ${requestError.message || \"Unknown error\"}`)\r\n        }\r\n      }\r\n      if (!accounts || accounts.length === 0) {\r\n        toast.error(\"No accounts found. Please connect MetaMask.\")\r\n        throw new Error(\"No accounts found in MetaMask\")\r\n      }\r\n      const selectedWallet = accounts[0]\r\n      const provider = new ethers.BrowserProvider(window.ethereum)\r\n      const signer = await provider.getSigner()\r\n      const metaMaskAddress = await signer.getAddress()\r\n      const normalizedSelected = ethers.getAddress(selectedWallet)\r\n      const normalizedSigner = ethers.getAddress(metaMaskAddress)\r\n      if (!bookingDetails) {\r\n        toast.error(\"Booking details are missing\")\r\n        throw new Error(\"Booking details are missing\")\r\n      }\r\n      if (bookingDetails.userWalletAddress) {\r\n        const normalizedTenant = ethers.getAddress(bookingDetails.userWalletAddress)\r\n        if (normalizedSigner.toLowerCase() !== normalizedTenant.toLowerCase()) {\r\n          const errorMsg = `Wallet mismatch. Please select the correct wallet in MetaMask. Expected: ${bookingDetails.userWalletAddress}, Selected: ${metaMaskAddress}`\r\n          toast.error(errorMsg)\r\n          throw new Error(errorMsg)\r\n        }\r\n      }\r\n      if (user?.id && bookingDetails.userId) {\r\n        const currentUserId = parseInt(user.id)\r\n        const bookingUserId = bookingDetails.userId\r\n        if (currentUserId !== bookingUserId) {\r\n          const errorMsg = `You are not authorized to pay for this booking. This booking belongs to user ${bookingUserId}, but you are logged in as user ${currentUserId}.`\r\n          toast.error(errorMsg)\r\n          throw new Error(errorMsg)\r\n        }\r\n      }\r\n      let valueBigNumber: ethers.BigNumberish\r\n      try {\r\n        if (typeof intentData.value === \"string\") {\r\n          if (intentData.value.startsWith(\"0x\")) {\r\n            valueBigNumber = intentData.value\r\n          } else {\r\n            const weiValue = BigInt(intentData.value)\r\n            valueBigNumber = weiValue\r\n          }\r\n        } else {\r\n          valueBigNumber = BigInt(intentData.value.toString())\r\n        }\r\n      } catch {\r\n        toast.error(`Invalid payment amount format: ${intentData.value}`)\r\n        return\r\n      }\r\n      if (!ethers.isAddress(intentData.to)) {\r\n        toast.error(`Invalid contract address: ${intentData.to}`)\r\n        return\r\n      }\r\n      const txData = intentData.data && intentData.data !== \"0x\" ? intentData.data : intentData.data || \"0x\"\r\n      const network = await provider.getNetwork()\r\n      if (intentData.chainId && network.chainId.toString() !== intentData.chainId.toString()) {\r\n        toast.error(`Network mismatch. Expected chain ID: ${intentData.chainId}, but current is: ${network.chainId}`)\r\n        return\r\n      }\r\n      const balance = await provider.getBalance(metaMaskAddress)\r\n      const balanceInEth = parseFloat(ethers.formatEther(balance))\r\n      const valueInEth = parseFloat(ethers.formatEther(valueBigNumber))\r\n      if (balanceInEth < valueInEth) {\r\n        toast.error(`Insufficient balance. You have ${balanceInEth.toFixed(4)} ETH but need ${valueInEth.toFixed(4)} ETH`)\r\n        return\r\n      }\r\n      // Estimate gas before sending transaction\r\n      let gasEstimate: bigint\r\n      try {\r\n        const estimatedGas = await provider.estimateGas({\r\n          to: intentData.to,\r\n          value: valueBigNumber,\r\n          data: txData,\r\n          from: metaMaskAddress,\r\n        })\r\n        gasEstimate = estimatedGas\r\n        console.log(`‚õΩ Estimated gas: ${gasEstimate.toString()}`)\r\n      } catch (gasError: any) {\r\n        console.error(`‚ùå Gas estimation failed: ${gasError.message}`)\r\n        // Use a safe default gas limit (300,000) if estimation fails\r\n        gasEstimate = BigInt(300000)\r\n        console.warn(`‚ö†Ô∏è Using default gas limit: ${gasEstimate.toString()}`)\r\n      }\r\n\r\n      const txRequest = {\r\n        to: intentData.to,\r\n        value: valueBigNumber,\r\n        data: txData,\r\n        gasLimit: gasEstimate + (gasEstimate / BigInt(10)), // Add 10% buffer\r\n      }\r\n      \r\n      console.log(`üì§ Sending transaction: to=${intentData.to}, value=${valueBigNumber.toString()}, gasLimit=${txRequest.gasLimit.toString()}`)\r\n      toast.info(\"Sending transaction... Please confirm in MetaMask.\")\r\n      const tx = await signer.sendTransaction(txRequest)\r\n      toast.info(\"Transaction sent, waiting for confirmation...\")\r\n      const receipt = await tx.wait()\r\n      if (!receipt) {\r\n        throw new Error(\"Transaction receipt is null\")\r\n      }\r\n      if (bookingId && receipt.hash) {\r\n        try {\r\n          await saveTransactionHash(bookingId, receipt.hash)\r\n        } catch {\r\n        }\r\n      }\r\n      if (receipt && receipt.hash) {\r\n        toast.success(`Payment deposited successfully! Transaction Hash: ${receipt.hash.substring(0, 10)}...`)\r\n      } else {\r\n        toast.success(\"Payment transaction sent successfully!\")\r\n      }\r\n      setTimeout(() => {\r\n        router.push(\"/my-bookings?tab=current\")\r\n      }, 2000)\r\n    } catch (e: any) {\r\n      let errorMessage = e.message || \"Failed to send transaction\"\r\n      if (e.code === 4001) {\r\n        errorMessage = \"Transaction rejected by user. Please approve the transaction in MetaMask.\"\r\n      } else if (e.code === -32603) {\r\n        // Internal JSON-RPC error - provide more specific error message\r\n        const errorDetails = e.data || e.error || {}\r\n        const rpcError = errorDetails.message || errorDetails.error || e.message || \"Unknown error\"\r\n        \r\n        if (rpcError.includes(\"execution reverted\") || rpcError.includes(\"revert\")) {\r\n          errorMessage = `Transaction reverted by contract. Possible reasons:\\n- Booking already exists\\n- Incorrect payment amount\\n- Invalid wallet address\\n- Contract validation failed\\n\\nDetails: ${rpcError}`\r\n        } else if (rpcError.includes(\"gas\") || rpcError.includes(\"out of gas\")) {\r\n          errorMessage = `Gas estimation failed. This might be due to:\\n- Contract execution would fail\\n- Insufficient gas limit\\n- Contract validation error\\n\\nDetails: ${rpcError}`\r\n        } else if (rpcError.includes(\"insufficient funds\") || rpcError.includes(\"balance\")) {\r\n          errorMessage = `Insufficient balance. Please add more ETH to your wallet.\\n\\nDetails: ${rpcError}`\r\n        } else {\r\n          errorMessage = `Internal JSON-RPC error. This might be due to:\\n- Insufficient balance\\n- Invalid contract address\\n- Network mismatch\\n- Invalid transaction data\\n- Contract execution error\\n\\nDetails: ${rpcError}`\r\n        }\r\n        \r\n        console.error(\"‚ùå JSON-RPC Error Details:\", {\r\n          code: e.code,\r\n          message: e.message,\r\n          data: e.data,\r\n          error: e.error,\r\n          rpcError: rpcError\r\n        })\r\n      } else if (e.code === \"CALL_EXCEPTION\" || e.reason) {\r\n        errorMessage = `Transaction failed: ${e.reason || e.message}`\r\n      } else if (e.message?.includes(\"insufficient funds\") || e.message?.includes(\"insufficient balance\")) {\r\n        errorMessage = \"Insufficient balance. Please add more ETH to your wallet.\"\r\n      } else if (e.message?.includes(\"network\") || e.message?.includes(\"chain\")) {\r\n        errorMessage = \"Network mismatch. Please switch to the correct network in MetaMask.\"\r\n      } else if (\r\n        e.message?.includes(\"user rejected\") ||\r\n        e.message?.includes(\"User denied\") ||\r\n        e.message?.includes(\"rejected\")\r\n      ) {\r\n        errorMessage = \"Transaction rejected by user. Please approve the transaction in MetaMask.\"\r\n      } else if (e.message?.includes(\"connection\") || e.message?.includes(\"connect\")) {\r\n        errorMessage = \"Failed to connect to MetaMask. Please make sure MetaMask is unlocked and try again.\"\r\n      }\r\n      toast.error(errorMessage)\r\n      throw e\r\n    }\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4\">\r\n        <Card className=\"max-w-md w-full p-8 text-center shadow-xl\">\r\n          <div className=\"flex justify-center mb-4\">\r\n            <AlertCircle className=\"w-16 h-16 text-red-500\" />\r\n          </div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Failed to Load Booking Details</h2>\r\n          <p className=\"text-gray-600 mb-6\">{error}</p>\r\n          <p className=\"text-sm text-gray-500 mb-6\">\r\n            Please make sure the booking ID in the URL is correct and the booking exists in the database.\r\n          </p>\r\n          <Button onClick={() => router.push(\"/my-bookings\")} variant=\"outline\" className=\"w-full\">\r\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n            Back to My Bookings\r\n          </Button>\r\n        </Card>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (bookingId === null || loadingDetails) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <Loader2 className=\"w-12 h-12 animate-spin text-teal-600 mx-auto mb-4\" />\r\n          <p className=\"text-gray-600 text-lg\">Loading booking details...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  const totalPrice = bookingDetails?.totalPrice || 0\r\n  const nights =\r\n    bookingDetails?.checkInDate && bookingDetails?.checkOutDate\r\n      ? Math.ceil(\r\n          (new Date(bookingDetails.checkOutDate).getTime() - new Date(bookingDetails.checkInDate).getTime()) /\r\n            (1000 * 60 * 60 * 24)\r\n        )\r\n      : 0\r\n\r\n  const currentWalletAddress = walletAddress || bookingDetails?.userWalletAddress\r\n  const hasWalletAddress =\r\n    currentWalletAddress && currentWalletAddress.trim() !== \"\" && currentWalletAddress !== \"null\"\r\n\r\n  const hasEthereum = typeof window !== \"undefined\" && window.ethereum\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          <div className=\"lg:col-span-2\">\r\n            <Card className=\"p-8 shadow-xl\">\r\n              <Button variant=\"ghost\" onClick={() => router.push(\"/my-bookings\")} className=\"mb-6 -ml-2\">\r\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n                Back\r\n              </Button>\r\n\r\n              <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Confirm and pay</h1>\r\n\r\n              <div className=\"space-y-8\">\r\n                <div>\r\n                  <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">1. Payment method</h2>\r\n                  <Card className=\"p-6 border-2 border-teal-600 bg-teal-50\">\r\n                    <div className=\"flex items-center gap-3 mb-4\">\r\n                      <Wallet className=\"w-6 h-6 text-teal-600\" />\r\n                      <span className=\"font-semibold text-gray-900\">Ethereum (MetaMask)</span>\r\n                    </div>\r\n\r\n                    {!hasWalletAddress ? (\r\n                      <Button\r\n                        onClick={connectWallet}\r\n                        className=\"w-full bg-teal-600 hover:bg-teal-700\"\r\n                      >\r\n                        <Wallet className=\"w-4 h-4 mr-2\" />\r\n                        Connect MetaMask\r\n                      </Button>\r\n                    ) : (\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <Label className=\"text-sm font-medium text-gray-700\">\r\n                            Currently Connected Wallet\r\n                          </Label>\r\n                          <Input\r\n                            value={currentWalletAddress}\r\n                            readOnly\r\n                            className={`mt-1 font-mono text-sm ${\r\n                              bookingDetails?.userWalletAddress &&\r\n                              currentWalletAddress?.toLowerCase() !==\r\n                                bookingDetails.userWalletAddress.toLowerCase()\r\n                                ? bookingDetails.ownerWalletAddress &&\r\n                                  currentWalletAddress?.toLowerCase() ===\r\n                                    bookingDetails.ownerWalletAddress.toLowerCase()\r\n                                  ? \"border-red-500 bg-red-50\"\r\n                                  : \"border-yellow-500 bg-yellow-50\"\r\n                                : \"border-green-500 bg-green-50\"\r\n                            }`}\r\n                          />\r\n                          {bookingDetails?.userWalletAddress &&\r\n                            currentWalletAddress?.toLowerCase() ===\r\n                              bookingDetails.userWalletAddress.toLowerCase() && (\r\n                              <p className=\"text-xs text-green-700 mt-1\">\r\n                                ‚úÖ Correct tenant wallet connected\r\n                              </p>\r\n                            )}\r\n                          {bookingDetails?.ownerWalletAddress &&\r\n                            currentWalletAddress?.toLowerCase() ===\r\n                              bookingDetails.ownerWalletAddress.toLowerCase() && (\r\n                              <p className=\"text-xs text-red-700 mt-1 font-semibold\">\r\n                                ‚ùå ERROR: You are connected with the HOST&apos;s wallet! Please\r\n                                switch to the tenant wallet above.\r\n                              </p>\r\n                            )}\r\n                          {bookingDetails?.userWalletAddress &&\r\n                            bookingDetails?.ownerWalletAddress &&\r\n                            currentWalletAddress?.toLowerCase() !==\r\n                              bookingDetails.userWalletAddress.toLowerCase() &&\r\n                            currentWalletAddress?.toLowerCase() !==\r\n                              bookingDetails.ownerWalletAddress.toLowerCase() && (\r\n                              <p className=\"text-xs text-yellow-700 mt-1\">\r\n                                ‚ö†Ô∏è WARNING: This wallet doesn&apos;t match the required tenant\r\n                                wallet. Payment will be deducted from this wallet.\r\n                              </p>\r\n                            )}\r\n                          <Button\r\n                            onClick={async () => {\r\n                              if (currentWalletAddress) {\r\n                                setWalletBalance(null)\r\n                                try {\r\n                                  await checkWalletInfo(currentWalletAddress)\r\n                                  toast.success(\"Wallet balance refreshed\")\r\n                                } catch (e: any) {\r\n                                  toast.error(`Failed to refresh: ${e.message}`)\r\n                                }\r\n                              } else {\r\n                                toast.error(\r\n                                  \"No wallet address available. Please connect MetaMask first.\"\r\n                                )\r\n                              }\r\n                            }}\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            className=\"mt-2 text-xs\"\r\n                            disabled={!currentWalletAddress}\r\n                          >\r\n                            Refresh Balance\r\n                          </Button>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <Label className=\"text-sm font-medium text-gray-700\">Network</Label>\r\n                          <Input value={networkName} readOnly className=\"mt-1\" />\r\n                        </div>\r\n\r\n                        <div>\r\n                          <Label className=\"text-sm font-medium text-gray-700\">Amount in ETH</Label>\r\n                          <Input\r\n                            value={\r\n                              totalPrice > 0\r\n                                ? `${totalPrice.toFixed(6)} ETH`\r\n                                : \"0.000000 ETH\"\r\n                            }\r\n                            readOnly\r\n                            className=\"mt-1\"\r\n                          />\r\n                        </div>\r\n\r\n                        <div>\r\n                          <Label className=\"text-sm font-medium text-gray-700\">\r\n                            Your Wallet Balance\r\n                          </Label>\r\n                          <Input\r\n                            value={\r\n                              walletBalance !== null\r\n                                ? `${walletBalance.toFixed(6)} ETH`\r\n                                : \"Checking...\"\r\n                            }\r\n                            readOnly\r\n                            className={`mt-1 ${\r\n                              walletBalance !== null &&\r\n                              totalPrice > 0 &&\r\n                              walletBalance < totalPrice + gasEstimate\r\n                                ? \"border-red-500\"\r\n                                : \"\"\r\n                            }`}\r\n                          />\r\n                          {walletBalance === null && (\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                              ‚è≥ Loading balance...\r\n                            </p>\r\n                          )}\r\n                          {walletBalance !== null && totalPrice > 0 && (\r\n                            <p\r\n                              className={`text-xs mt-1 ${\r\n                                walletBalance >= totalPrice + gasEstimate\r\n                                  ? \"text-green-600\"\r\n                                  : \"text-red-600\"\r\n                              }`}\r\n                            >\r\n                              {walletBalance >= totalPrice + gasEstimate\r\n                                ? \"‚úì Sufficient balance\"\r\n                                : `‚úó Insufficient balance. You need ${(totalPrice + gasEstimate).toFixed(\r\n                                    6\r\n                                  )} ETH`}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n\r\n                        {(!hasEthereum || !isCorrectNetwork) && (\r\n                          <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n                            <p className=\"text-sm font-medium text-yellow-800 mb-2\">\r\n                              MetaMask Status:\r\n                            </p>\r\n                            <p className=\"text-sm text-yellow-700\">\r\n                              {!hasEthereum\r\n                                ? \"‚úó MetaMask not installed\"\r\n                                : \"‚úó Wrong Network - Please switch to Hardhat Local or Arbitrum One\"}\r\n                            </p>\r\n                            {hasEthereum && !isCorrectNetwork && (\r\n                              <div className=\"flex gap-2 mt-3\">\r\n                                <Button\r\n                                  onClick={async () => {\r\n                                    try {\r\n                                      await switchToNetwork(\r\n                                        HARDHAT_CHAIN_ID,\r\n                                        \"Hardhat Local\",\r\n                                        \"http://127.0.0.1:8545\"\r\n                                      )\r\n                                      await checkWalletInfo(\r\n                                        walletAddress || bookingDetails?.userWalletAddress || \"\"\r\n                                      )\r\n                                      toast.success(\"Switched to Hardhat Local\")\r\n                                    } catch (e: any) {\r\n                                      toast.error(`Failed to switch: ${e.message}`)\r\n                                    }\r\n                                  }}\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  className=\"text-xs\"\r\n                                >\r\n                                  Switch to Hardhat Local\r\n                                </Button>\r\n                                <Button\r\n                                  onClick={async () => {\r\n                                    try {\r\n                                      await switchToNetwork(\r\n                                        ARBITRUM_ONE_CHAIN_ID,\r\n                                        \"Arbitrum One\",\r\n                                        \"https://arb1.arbitrum.io/rpc\"\r\n                                      )\r\n                                      await checkWalletInfo(\r\n                                        walletAddress || bookingDetails?.userWalletAddress || \"\"\r\n                                      )\r\n                                      toast.success(\"Switched to Arbitrum One\")\r\n                                    } catch (e: any) {\r\n                                      toast.error(`Failed to switch: ${e.message}`)\r\n                                    }\r\n                                  }}\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  className=\"text-xs\"\r\n                                >\r\n                                  Switch to Arbitrum One\r\n                                </Button>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </Card>\r\n                </div>\r\n\r\n                {!formValid && !loading && (\r\n                  <Card className=\"p-6 bg-amber-50 border-amber-200\">\r\n                    <div className=\"flex gap-3\">\r\n                      <AlertCircle className=\"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5\" />\r\n                      <div>\r\n                        <h3 className=\"font-semibold text-amber-900 mb-2\">\r\n                          Please complete the following:\r\n                        </h3>\r\n                        <ul className=\"space-y-1 text-sm text-amber-800\">\r\n                          {(!bookingDetails || !bookingId) && (\r\n                            <li>‚Ä¢ Booking details are missing</li>\r\n                          )}\r\n                          {!walletAddress && !bookingDetails?.userWalletAddress && (\r\n                            <li>‚Ä¢ Connect your MetaMask wallet</li>\r\n                          )}\r\n                          {(!bookingDetails?.ownerWalletAddress ||\r\n                            bookingDetails?.ownerWalletAddress === \"N/A\") && (\r\n                            <li>‚Ä¢ Property owner wallet address is missing</li>\r\n                          )}\r\n                          {(!networkName || networkName === \"Not connected\") && (\r\n                            <li>‚Ä¢ Connect to a supported network</li>\r\n                          )}\r\n                          {!isCorrectNetwork && (\r\n                            <li>‚Ä¢ Switch to Hardhat Local or Arbitrum One network</li>\r\n                          )}\r\n                          {(!bookingDetails?.totalPrice ||\r\n                            bookingDetails.totalPrice <= 0) && (\r\n                            <li>‚Ä¢ Booking price is invalid</li>\r\n                          )}\r\n                          {(gasEstimate === null || gasEstimate === undefined) && (\r\n                            <li>‚Ä¢ Gas estimate is being calculated</li>\r\n                          )}\r\n                          {(walletBalance === null ||\r\n                            walletBalance === undefined) && (\r\n                            <li>‚Ä¢ Wallet balance is being checked</li>\r\n                          )}\r\n                          {walletBalance !== null &&\r\n                            walletBalance !== undefined &&\r\n                            bookingDetails &&\r\n                            bookingDetails.totalPrice > 0 &&\r\n                            walletBalance < bookingDetails.totalPrice + gasEstimate && (\r\n                              <li>\r\n                                ‚Ä¢ Insufficient balance. You need{\" \"}\r\n                                {(bookingDetails.totalPrice + gasEstimate).toFixed(6)} ETH\r\n                              </li>\r\n                            )}\r\n                          {!hasEthereum && (\r\n                            <li>‚Ä¢ MetaMask extension is not installed</li>\r\n                          )}\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </Card>\r\n                )}\r\n\r\n                <Button\r\n                  onClick={async (e) => {\r\n                    e.preventDefault()\r\n                    e.stopPropagation()\r\n                    if (!loading && formValid) {\r\n                      try {\r\n                        await createPaymentIntent()\r\n                      } catch (err: any) {\r\n                        toast.error(\r\n                          `Error: ${err?.message || err?.toString() || \"Unknown error\"}`\r\n                        )\r\n                      }\r\n                    } else {\r\n                      if (loading) {\r\n                        toast.info(\"Please wait, processing...\")\r\n                      } else {\r\n                        const reasons: string[] = []\r\n                        if (!bookingDetails || !bookingId) reasons.push(\"Booking details missing\")\r\n                        if (!walletAddress && !bookingDetails?.userWalletAddress)\r\n                          reasons.push(\"Wallet not connected\")\r\n                        if (!bookingDetails?.ownerWalletAddress || bookingDetails.ownerWalletAddress === \"N/A\")\r\n                          reasons.push(\"Owner wallet missing\")\r\n                        if (!networkName || networkName === \"Not connected\")\r\n                          reasons.push(\"Network not connected\")\r\n                        if (!isCorrectNetwork) reasons.push(\"Wrong network\")\r\n                        if (!bookingDetails?.totalPrice || bookingDetails.totalPrice <= 0)\r\n                          reasons.push(\"Invalid price\")\r\n                        if (walletBalance === null || walletBalance === undefined)\r\n                          reasons.push(\"Balance not loaded\")\r\n                        if (\r\n                          walletBalance !== null &&\r\n                          bookingDetails &&\r\n                          walletBalance < bookingDetails.totalPrice + gasEstimate\r\n                        )\r\n                          reasons.push(\"Insufficient balance\")\r\n                        if (!hasEthereum) reasons.push(\"MetaMask not installed\")\r\n                        toast.error(\r\n                          `Please complete all required fields: ${reasons.join(\", \")}`\r\n                        )\r\n                      }\r\n                    }\r\n                  }}\r\n                  disabled={loading || !formValid}\r\n                  className=\"w-full bg-teal-600 hover:bg-teal-700 text-white disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  size=\"lg\"\r\n                  type=\"button\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                      Processing...\r\n                    </>\r\n                  ) : (\r\n                    \"Confirm reservation\"\r\n                  )}\r\n                </Button>\r\n              </div>\r\n            </Card>\r\n          </div>\r\n\r\n          {bookingDetails && (\r\n            <div className=\"lg:col-span-1\">\r\n              <Card className=\"p-6 shadow-xl sticky top-8\">\r\n                <div className=\"mb-6\">\r\n                  <div className=\"w-full h-48 bg-gradient-to-br from-teal-400 to-blue-500 rounded-lg mb-4 flex items-center justify-center\">\r\n                    <span className=\"text-white text-xl font-semibold\">\r\n                      {bookingDetails.propertyTitle || \"Property\"}\r\n                    </span>\r\n                  </div>\r\n                  <span className=\"inline-block px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-xs font-medium\">\r\n                    {bookingDetails.status || \"PENDING\"}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"space-y-4 mb-6\">\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <Calendar className=\"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5\" />\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"text-sm font-medium text-gray-500\">Check-in</p>\r\n                      <p className=\"text-base text-gray-900\">\r\n                        {bookingDetails.checkInDate\r\n                          ? new Date(bookingDetails.checkInDate).toLocaleDateString(\"en-US\", {\r\n                              year: \"numeric\",\r\n                              month: \"short\",\r\n                              day: \"numeric\",\r\n                            })\r\n                          : \"N/A\"}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <Calendar className=\"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5\" />\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"text-sm font-medium text-gray-500\">Check-out</p>\r\n                      <p className=\"text-base text-gray-900\">\r\n                        {bookingDetails.checkOutDate\r\n                          ? new Date(bookingDetails.checkOutDate).toLocaleDateString(\"en-US\", {\r\n                              year: \"numeric\",\r\n                              month: \"short\",\r\n                              day: \"numeric\",\r\n                            })\r\n                          : \"N/A\"}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <User className=\"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5\" />\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"text-sm font-medium text-gray-500\">Guest</p>\r\n                      <p className=\"text-base text-gray-900\">\r\n                        {bookingDetails.userFirstName && bookingDetails.userLastName\r\n                          ? `${bookingDetails.userFirstName} ${bookingDetails.userLastName}`\r\n                          : bookingDetails.userEmail || \"N/A\"}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"border-t pt-6\">\r\n                  <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Price details</h3>\r\n                  <div className=\"space-y-3\">\r\n                    {nights > 0 && bookingDetails.propertyPrice > 0 && (\r\n                      <div className=\"flex justify-between text-sm\">\r\n                        <span className=\"text-gray-600\">\r\n                          {nights} {nights === 1 ? \"night\" : \"nights\"} √ó{\" \"}\r\n                          {bookingDetails.propertyPrice.toFixed(6)} ETH\r\n                        </span>\r\n                        <span className=\"text-gray-900\">\r\n                          {(bookingDetails.propertyPrice * nights).toFixed(6)} ETH\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex justify-between text-base font-semibold pt-3 border-t\">\r\n                      <span className=\"text-gray-900\">Total</span>\r\n                      <span className=\"text-gray-900\">{totalPrice.toFixed(6)} ETH</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Wallet\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgN1Y0YTEgMSAwIDAgMC0xLTFINWEyIDIgMCAwIDAgMCA0aDE1YTEgMSAwIDAgMSAxIDF2NGgtM2EyIDIgMCAwIDAgMCA0aDNhMSAxIDAgMCAwIDEtMXYtMmExIDEgMCAwIDAtMS0xIiAvPgogIDxwYXRoIGQ9Ik0zIDV2MTRhMiAyIDAgMCAwIDIgMmgxNWExIDEgMCAwIDAgMS0xdi00IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/wallet\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Wallet = createLucideIcon('Wallet', [\n  [\n    'path',\n    {\n      d: 'M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1',\n      key: '18etb6',\n    },\n  ],\n  ['path', { d: 'M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4', key: 'xoc0q4' }],\n]);\n\nexport default Wallet;\n"],"names":[],"mappings":"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","ignoreList":[1]}